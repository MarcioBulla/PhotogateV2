
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="color-scheme" content="light dark"/>
  <title>Photogate V2 - ESP32 Optical Timer</title>

  <link rel="icon" href="icon.png"/>

  <!-- Preconnect for CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>

  <!-- Main CSS (cache-busting) -->
  <link rel="stylesheet" href="styles.css?v=4"/>

  <!-- Prism (optional for code blocks) -->
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet"/>

  <!-- model-viewer (Web Component) -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <!-- App (defer to load after HTML) -->
  <script src="app.js?v=3" defer></script>

  <!-- Nerd Fonts (JetBrainsMono + Symbols) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mshaugh/nerdfont-webfonts@v3.3.0/build/jetbrainsmono.css" crossorigin>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mshaugh/nerdfont-webfonts@v3.3.0/build/nerdfontssymbolsonly.css" crossorigin>

  <!-- JS disabled notice -->
  <noscript>
    <style>
      .no-js-banner{background:#ffeded;color:#6b0000;padding:.75rem 1rem;margin:0;border-bottom:2px solid #e0b4b4;font:600 14px/1.4 ui-sans-serif,system-ui;}
    </style>
    <div class="no-js-banner">JavaScript is disabled. Some features (theme, 3D viewer, copy code) will not work.</div>
  </noscript>
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <h1 id="projectName">Photogate V2</h1>
        </div>
        <div class="header-right">
          <button id="themeToggle" class="btn" type="button">
            <span class="nf nf-moon" aria-hidden="true"></span> Dark Mode
          </button>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Hero -->
    <section class="hero fade-in">
      <div class="version-badge" id="versionBadge">Version 2.1</div>
      <h2 id="heroTitle">Photogate V2</h2>
      <p id="heroTagline">High-precision optical timer based on ESP32</p>

      <!-- BUTTON GROUP (alinhado e sem quebrar layout) -->
      <div class="btn-group">
        <a id="btnGithub" href="https://github.com/MarcioBulla/PhotogateV2" class="btn" target="_blank" rel="noopener">
          <span class="nf nf-github" aria-hidden="true"></span> GitHub
        </a>
        <a id="btnIBOM" href="#ibom" class="btn" rel="noopener">
          <!-- mantém SVG (link) como estava -->
          <img class="ibom-inline" src="https://raw.githubusercontent.com/openscopeproject/InteractiveHtmlBom/f42ee38fc93ecb7d619eb63db897cb2477d98423/icons/plugin.svg" alt="" aria-hidden="true">
          View IBOM
        </a>
      </div>
    </section>

    <!-- Overview -->
    <section class="section">
      <h3 id="overviewTitle">Overview</h3>
      <div class="card">
        <p id="overviewBody">
          Photogate V2 brings improved accuracy, reliability, and a clean interface for educational physics experiments on the ESP32 platform. The project is open hardware and uses a fully open-source toolchain for CAD and firmware.
        </p>
        <div class="tech-stack">
          <div class="tech-item">ESP-IDF v5.4.2</div>
          <div class="tech-item">ESP32</div>
          <div class="tech-item">Open Hardware</div>
          <div class="tech-item">FreeRTOS</div>
        </div>
      </div>
    </section>

    <!-- Characteristics -->
    <section class="section">
      <h3 id="charTitle">Characteristics</h3>
      <div class="features-grid">
        <div class="feature-card">
            <img class="feature-logo" src="https://www.espressif.com/sites/all/themes/espressif/images/logo-guidelines/primary-vertical-logo.png" alt="Espressif logo"/>
          <h4>High Precision</h4>
          <p>Uses the ESP32’s <strong>internal high-resolution timer/counter</strong> with a <strong>FreeRTOS</strong>-based design for deterministic, accurate measurements.</p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <img class="feature-logo" src="https://upload.wikimedia.org/wikipedia/commons/3/3e/FreeRTOS_logo_2005.svg" alt="FreeRTOS logo"/>
          </div>
          <h4>FreeRTOS Firmware</h4>
          <p>Task-based architecture improves responsiveness and timing isolation (ISR → queue → measurement task).</p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <img class="feature-logo" src="https://upload.wikimedia.org/wikipedia/commons/6/65/KiCad_logo_square.svg" alt="KiCad logo"/>
          </div>
          <h4>KiCad (PCB)</h4>
          <p>PCB layout and schematics created with the open-source KiCad suite.</p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <img class="feature-logo" src="https://upload.wikimedia.org/wikipedia/commons/1/1a/FreeCAD-symbol.svg" alt="FreeCAD logo"/>
          </div>
          <h4>FreeCAD (3D)</h4>
          <p>Parametric enclosure modeled with FreeCAD for easy editing and printing.</p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <img class="feature-logo" src="https://upload.wikimedia.org/wikipedia/commons/f/fd/Open-source-hardware-logo.svg" alt="Open-source Hardware logo"/>
          </div>
          <h4>Open Hardware</h4>
          <p>All design files are published for study, modification, and reuse.</p>
        </div>

                
        <div class="feature-card">
          <div class="feature-icon">
            <span class="nf nf-printer_3d_nozzle" aria-hidden="true"></span>
          </div>
          <h4>Easy to Print</h4>
          <p>The case parts are <strong>easy to 3D print</strong> — no supports needed.</p>
        </div>
      </div>
    </section>

    <!-- IBOM -->
    <section id="ibom" class="section ibom-section">
      <h3 id="ibomTitle">Interactive BOM</h3>
      <div class="card ibom-container" style="padding:0;overflow:hidden">
        <div class="ibom-header">
          <img class="ibom-icon" src="https://raw.githubusercontent.com/openscopeproject/InteractiveHtmlBom/f42ee38fc93ecb7d619eb63db897cb2477d98423/icons/plugin.svg" alt="iBOM icon"/>
          <span>Interactive Bill of Materials</span>
        </div>
        <iframe id="ibom-iframe" src="ibom.html" width="100%" height="520" style="border:none">
          Your browser does not support iframes.
        </iframe>
      </div>
    </section>

    <!-- 3D Preview -->
    <section class="section">
      <h3 id="previewTitle">Interactive 3D Preview</h3>

      <div class="viewer-bar">
        <div class="viewer-title">3D</div>
        <div class="viewer-controls">
          <button class="btn viewer-btn" data-key="board" type="button" aria-pressed="false" id="btnBoard">Board</button>
          <button class="btn viewer-btn active" data-key="case" type="button" aria-pressed="true" id="btnCase">Case</button>
        </div>
      </div>

      <div class="viewer-wrap">
        <model-viewer
          id="pg-viewer"
          src="3dmodels/case.gltf"
          alt="Photogate V2 – Case 3D"
          camera-controls
          auto-rotate
          auto-rotate-delay="2000"
          interaction-prompt="none"
          touch-action="pan-y"
          shadow-intensity="1"
          exposure="1"
          style="background: rgba(128,128,128,0.15)"
        ></model-viewer>
      </div>
    </section>

    <!-- Build and Run -->
    <section class="section">
      <h3 id="buildTitle">Build and Run</h3>
      <div class="card">
        <h4 id="reqTitle">Requirements</h4>
        <ul class="req-list">
          <li id="req1"><strong>ESP-IDF v5.4.2</strong></li>
          <li id="req2">A configured ESP32 development environment (terminal toolchain)</li>
          <li id="req3">Required cables and hardware to flash the firmware</li>
        </ul>

        <h4 id="qsTitle">Quick Start</h4>

        <p id="qsCloneTitle"><strong>1) Clone the repository</strong></p>
        <div class="code-wrapper">
          <button class="btn" onclick="copyCode(this)">Copy</button>
          <pre><code class="language-bash">git clone https://github.com/MarcioBulla/PhotogateV2.git
cd PhotogateV2
</code></pre>
        </div>

        <p id="qsEnvTitle"><strong>2) Set up the ESP-IDF environment</strong></p>
        <p id="qsEnvDesc">
          Follow the official guide:
          <a class="btn btn-inline" href="https://docs.espressif.com/projects/esp-idf" target="_blank" rel="noopener">Get Started with ESP-IDF</a>
        </p>

        <p id="qsBuildTitle"><strong>3) Build, flash, and monitor</strong></p>
        <div class="code-wrapper">
          <button class="btn" onclick="copyCode(this)">Copy</button>
          <pre><code class="language-bash">cd firmware
idf.py build flash monitor
</code></pre>
        </div>
      </div>
    </section>

    <!-- Repo structure (substitui emojis por Nerd Fonts) -->
    <section class="section">
      <h3 id="repoTitle">Repository Structure</h3>
      <div class="card">
        <ul class="repository-list">
          <li><div class="folder-name"><span class="nf nf-oct-file_directory" aria-hidden="true"></span> firmware/</div><div id="repoFirmware">C source code for ESP32 firmware</div></li>
          <li><div class="folder-name"><span class="nf nf-oct-file_directory" aria-hidden="true"></span> boards/</div><div id="repoBoards">PCB layouts or circuit schematics</div></li>
          <li><div class="folder-name"><span class="nf nf-oct-file_directory" aria-hidden="true"></span> 3DModels/</div><div id="repo3d">Printable or viewable 3D models of the device</div></li>
          <li><div class="folder-name"><span class="nf nf-oct-file" aria-hidden="true"></span> README.md</div><div id="repoReadme">Project documentation</div></li>
        </ul>
      </div>
    </section>
  </main>


<footer>
  <div class="container footer-flex">
    <div class="footer-text">
      <p id="footerLine1">
        &copy; 2025 Photogate V2 - Developed by <strong>Marcio Bulla</strong>
      </p>
      <p id="footerLine2" class="footer-sub">
        Inspired by the first Photogate (Optical Timer) version<br/>
        <span class="footer-thanks-text">Special thanks to <strong>Fabiano Yokaichiya</strong></span>
      </p>
    </div>

    <div class="footer-seal">
      <img src="images/FabianoYokaichiyaSeal.png" alt="Seal of Fabiano Yokaichiya">
    </div>
  </div>
</footer>


  <!-- Prism core + autoloader (optional) -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <script>
    if (window.Prism && Prism.plugins && Prism.plugins.autoloader) {
      Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
    }
  </script>
</body>
</html>

